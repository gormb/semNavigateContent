<!DOCTYPE html>
<html>
<head>
    <title>Big 6 Traits</title><meta charset='utf-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='semNavigateContent_Big6.css'>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-database.js"></script>
    <script src="semNavigateContent_Big6.js"></script>
    <script src="semNavigateContent_Big6_qr.js"></script>
    <script src="semNavigateContent_Big6_firebase.js"></script>
    <script>
        var bYes = -1, bNo = -1;
        function SetYN(cell, y, n) {
            // if (Number.isInteger(parseInt(cell)))
            //     cell = document.getElementById("b" + cell);
            if (y != null) {
                bYes = y;
                cell.classList.toggle("yes");
            }
            if (n != null) {
                bNo = n;
                cell.classList.toggle("no");
            }
        }
    </script><script>
        function TraitsClear() { // clear names and percentages of traits since no test chosen
            t0.innerHTML = t1.innerHTML = t2.innerHTML = t3.innerHTML = t4.innerHTML = t5.innerHTML = '';
            t0.style.borderColor = t1.style.borderColor = t2.style.borderColor = t3.style.borderColor = t4.style.borderColor = t5.style.borderColor =
                t0c.style.borderColor = t1c.style.borderColor = t2c.style.borderColor = t3c.style.borderColor = t4c.style.borderColor = t5c.style.borderColor = 'gray';
        }
        function TraitsPopulate() { // set names of traits for the test chosen
            for (var i = 0; i < 6; i++) {
                if (i < big6_scores.length) 
                    document.getElementById("t" + i).innerHTML = big6_scores[i][i_trait][i_belieftext];
            }
        }
        function TraitsUpdate() { // update percentages for traits based upon answers given, update gui
            //alert("TraitsUpdate " + big6_menu[bYes][i_belieftext] + " " + big6_menu[bNo][i_belieftext]);
            big6_UpdateScores(bYes, bNo);
            bResults.style.display = 'table';
            //bResults.style.visibility = "visible";
            for (var i = 0; i < 6; i++)
                if (i < big6_scores.length)
                    { // var big6_scores = new Array(), i_trait=0, i_statements = 1, i_yesno=2, i_opportunitythreat=3;
                        var t = document.getElementById("t" + i), tc = document.getElementById("t" + i + "c"), trait = big6_scores[i];
                        var t_c = trait[i_statements].length;
                        tc.style.borderColor = t_c < 1 ? 'grey' : t_c < 2 ? 'yellow' :  'green';
                        if (t_c < 2)
                            bResults.style.display = 'none';
                            //bResults.style.visibility = "hidden";
                    }
        }
    </script><script>
        function selectButton(b, cell) {
            if (big6_testIndex == 0) { // Menu click! set test and navigate to first choice!
                big6_SetTestIndex(big6_menu[b][i_beliefid]);
                big6_Url(big6_testIndex, 1);
                TraitsPopulate();
                StatementPopulate(); // populate the first statement
            }
            else { 
                if (bYes == b) SetYN(cell, -1); // turn off yes
                else if (bNo == b) SetYN(cell, null, -1); // turn off no
                else if (bYes == -1) SetYN(cell, b); // set yes
                else if (bNo == -1) SetYN(cell, null, b); // set no
            }
            bNext.style.display = bYes == -1 || bNo == -1 ? "none" : "table";
            bSkip.style.display = bYes != -1 || bNo != -1 ? "none" : "table";
        }
        function StatementReset(b_i, t) {
            var b = document.getElementById("b" + b_i);
            b.classList.remove("yes");
            b.classList.remove("no");
            try { b.innerHTML = t[i_belieftext]; } // If an array, then text is the i_belieftext-th element
            catch (e) { b.innerHTML = t; }// not an array, t is a string
        }
        function ifnull(s, d = "", extra="") { return (s === null ? d : s) + extra; }
        function StatementPopulate(i, s0, s1, s2, s3) {
            if (i == null) { // Find four fitting statements
                if (big6_testIndex == 0) { // Menu click! set test and navigate to first choice!
                    big6_menu = big6_GetChildren(0);
                    TraitsClear();
                }
                else
                    big6_menu = big6_GetStatements().slice(0, 4);  // Return only the first four elements;
                StatementPopulate(0, big6_menu[0], big6_menu.length > 1 ? big6_menu[1]:null, big6_menu.length > 2 ? big6_menu[2]:null, big6_menu.length > 3 ? big6_menu[3]:null);
            }
            else { // values (or arrays)
                StatementReset(0, s0);
                StatementReset(1, s1);
                StatementReset(2, s2);
                StatementReset(3, s3);
                bYes = bNo = -1;
                bNext.style.display = "none";
                bSkip.style.display =
                    bReset.style.display = big6_testIndex == 0 ? "none" : "table";
            }
        }
      </script>
</head>
<body onload="StatementPopulate();big6_Navigate(new URLSearchParams(window.location.search).get('test').toString())">

<table id="buttonsTable" style="width: 100vw;height:20vh;"><tr><td style="border-width: 0px;">
<b>Din mening</b>
Velg uttalelse som passer best, og den som passer d√•rligst
<a href="?test=200000,211000y2,232000n3,232000.1,232000.0,!,221000y2,222000n3,232000.1,232000.0,!,241000y2,212000n3,232000.1,232000.0,!,251000y2,202000n3,232000.1,232000.0,!,211000y2,252000n3,232000.1,232000.0,!,241000y2,232000n3,232000.1,232000.0,!,$">simuler big5</a>
<a href="?test=300000,311000y2,332000n3,332000.1,332000.0,!,321000y2,322000n3,332000.1,332000.0,!,341000y2,312000n3,332000.1,332000.0,!,351000y2,302000n3,332000.1,332000.0,!,311000y2,352000n3,332000.1,332000.0,!,341000y2,332000n3,332000.1,332000.0,!,$">norsk</a>
</td><td id="traits" style="border-width: 4px; border-color: white;user-select: none;">
    <table style="width: 45vw;height:100%;">
        <tr><td id="t0c" class="trait"><div id="t0" class="trait" onclick="ShowTraits(0);">&nbsp;</div></td><td id="t1c" class="trait"><div id="t1" class="trait" onclick="ShowTraits(1);">&nbsp;</div></td><td id="t2c" class="trait"><div id="t2" class="trait" onclick="ShowTraits(2);">&nbsp;</div></td>
        </tr><tr><td id="t3c" class="trait"><div id="t3" class="trait" onclick="ShowTraits(3);">&nbsp;</div></td><td id="t4c" class="trait"><div id="t4" class="trait" onclick="ShowTraits(4);">&nbsp;</div></td><td id="t5c" class="trait"><div id="t5" class="trait" onclick="ShowTraits(5);">&nbsp;</div></td></tr>
    </table>
</td></tr></table>

<table id="traitsTable" style="top: 20%; position: absolute;width: 95vw;height: 80vh;border-spacing: 6px;user-select: none;">
<tr><td id="b0" onclick="selectButton(0, this)">
</td><td id="b1" onclick="selectButton(1, this)">
</td></tr><tr><td id="b2" onclick="selectButton(2, this)">
</td><td id="b3" onclick="selectButton(3, this)">
</td></tr></table>

<table id="traitDetailsTable" style="z-index: 1; display:none;position: absolute;left: 0%; top: 20%; width: 95vw;height: 80%;border-spacing: 4px;user-select: none;">
<tr><td id="traitsDetail" onclick="traitDetailsTable.style.display='none'">Trait</td>
</tr></table>

<script>
function Click_Reset() {
    big6_Url('', 1);
    bResults.style.display='none';
    big6_testIndex=0;
    StatementPopulate();
}
function Click_Next() {
    big6_Url('!', 0);
    TraitsUpdate();
    StatementPopulate();
}
function Click_Skip() { 
    big6_Url('-', 0);
    TraitsUpdate();
    StatementPopulate();
}
function Click_Results() { 
    big6_Url('$', 0);
    ShowTraits(null);
}
</script>

<button id="bNext" onclick="Click_Next();" style="position: absolute; left:35%; top:56%; width:20%; height: 8%;font-size: larger;">&#x27A1;&#x2753;</button>
<button id="bSkip" onclick="Click_Skip();" style="display:none; position: absolute; left:35%; top:56%; width:20%; height: 8%;font-size: larger;">&#x27A1;&#x23ED;</button>
<button id="bResults" onclick="Click_Results();" style="display:none; position: absolute; left:65%; top:6%; width:20%; height: 8%;font-size: larger;">&#x2705;&#x2753;</button>
<button id="bReset" onclick="Click_Reset();" style="position: absolute; left:75%; top:90%; width:20%; height: 8%;font-size: larger;">&#x21BA;&#x2190;</button>

<div style="display:none;position: absolute; left:10%; top:80%; width:10%; height: 8%;font-size: larger;">
    <input type="button" value="Sign In" onclick="RegisterUser('110751039536784560815')" />
    Link:<input type="text" value="randomId" /><input type="button" value="Show link" onclick="QrGenerateLink('110751039536784560815')" />
</div>
</body>
</html>